{% include 'header.html' %}

<div class="container my-5">
  <h2 class="text-center mb-4">Personality Quiz</h2>
  <div id="quiz-container" class="card shadow-lg p-4">
    <div id="question-container"></div>
    <div class="d-flex justify-content-between mt-3">
      <button id="prev-btn" class="btn btn-secondary" disabled>Previous</button>
      <button id="next-btn" class="btn btn-primary">Next</button>
    </div>
  </div>
</div>

<!-- Popup Modal -->
<div id="resultModal" class="modal">
  <div class="modal-content text-center">
    <h3 id="resultText"></h3>
    <button id="shareWhatsapp" class="btn btn-success mt-3">Share on WhatsApp</button>
    <button id="shareFacebook" class="btn btn-primary mt-3">Share on Facebook</button>
    <button id="closeModal" class="btn btn-danger mt-3">Close</button>
  </div>
</div>

{% include 'footer.html' %}

<script>
document.addEventListener("DOMContentLoaded", () => {
  const questions = [
    { q: "You enjoy working in groups?", options: ["Strongly Agree", "Agree", "Disagree", "Strongly Disagree"] },
    { q: "You prefer detailed planning over spontaneity?", options: ["Strongly Agree", "Agree", "Disagree", "Strongly Disagree"] },
    { q: "Do you like solving logical problems?", options: ["Strongly Agree", "Agree", "Disagree", "Strongly Disagree"] },
    { q: "Are you more creative than analytical?", options: ["Strongly Agree", "Agree", "Disagree", "Strongly Disagree"] },
  ];

  let currentQ = 0;
  let answers = [];

  function showQuestion(index) {
    const q = questions[index];
    const container = document.getElementById("question-container");
    container.innerHTML = `
      <h5>${q.q}</h5>
      ${q.options.map((opt, i) => `
        <div class="form-check">
          <input class="form-check-input" type="radio" name="q${index}" value="${opt}" id="opt${index}-${i}">
          <label class="form-check-label" for="opt${index}-${i}">${opt}</label>
        </div>
      `).join("")}
    `;
  }

  document.getElementById("next-btn").addEventListener("click", () => {
    const selected = document.querySelector(`input[name="q${currentQ}"]:checked`);
    if (!selected) { alert("Please select an option!"); return; }
    answers[currentQ] = selected.value;
    if (currentQ < questions.length - 1) {
      currentQ++;
      showQuestion(currentQ);
      document.getElementById("prev-btn").disabled = false;
      if (currentQ === questions.length - 1) {
        document.getElementById("next-btn").textContent = "Finish";
      }
    } else {
      showResult();
    }
  });

  document.getElementById("prev-btn").addEventListener("click", () => {
    if (currentQ > 0) {
      currentQ--;
      showQuestion(currentQ);
      if (currentQ === 0) document.getElementById("prev-btn").disabled = true;
      document.getElementById("next-btn").textContent = "Next";
    }
  });

  function showResult() {
    let personality = "ðŸŽ‰ Creative Thinker"; // you can compute later
    document.getElementById("resultText").textContent = `Your Personality Result: ${personality}`;
    document.getElementById("resultModal").style.display = "flex";

    document.getElementById("shareWhatsapp").onclick = () => {
      const url = `https://api.whatsapp.com/send?text=My personality type is ${personality}`;
      window.open(url, "_blank");
    };

    document.getElementById("shareFacebook").onclick = () => {
      const url = `https://www.facebook.com/sharer/sharer.php?quote=My personality type is ${personality}`;
      window.open(url, "_blank");
    };
  }

  document.getElementById("closeModal").onclick = () => {
    document.getElementById("resultModal").style.display = "none";
  };

  // ðŸ‘‰ Initial render
  showQuestion(currentQ);
});
</script>

<style>
.modal {
  display: none; position: fixed; z-index: 1000;
  left: 0; top: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.6); display:flex; justify-content:center; align-items:center;
}
.modal-content {
  background: #fff; padding: 20px; border-radius: 10px; width: 400px;
}
</style>
